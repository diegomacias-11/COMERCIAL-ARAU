{% extends "lista.html" %}
{% load comisiones_extras %}

{% block title %}Gastos de Mercadotecnia{% endblock %}

{% block filtros_left %}{% endblock %}

{% block filtros %}
  <form method="get" class="filter-form-simple">
    <div class="filter-block">
      <label for="fecha_desde">Fecha inicio</label>
      <input type="date" id="fecha_desde" name="fecha_desde" value="{{ fecha_desde }}">
    </div>
    <span class="filter-separator"></span>
    <div class="filter-block">
      <label for="fecha_hasta">Fecha fin</label>
      <input type="date" id="fecha_hasta" name="fecha_hasta" value="{{ fecha_hasta }}">
    </div>
    <span class="filter-separator"></span>
    <div class="filter-block">
      <label for="marca">Marca</label>
      <select id="marca" name="marca">
        <option value="">Todas</option>
        {% for val, label in marca_choices %}
          <option value="{{ val }}" {% if marca == val %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="filter-actions">
      <button type="submit" class="btn-filter">Filtrar</button>
      <a href="{% url 'gastos_mercadotecnia_gasto_list' %}" class="btn-filter">Limpiar</a>
    </div>
  </form>
{% endblock %}

{% block filtros_right %}
  <a href="{% url 'gastos_mercadotecnia_gasto_create' %}?next={{ request.get_full_path|urlencode }}" class="btn-primary btn-primary-inline">Nueva inversión</a>
{% endblock %}

{% block tabla_head %}
  <tr>
    <th>Acciones</th>
    <th>Fecha de facturación</th>
    <th>Categoría</th>
    <th>Plataforma</th>
    <th>Marca</th>
    <th>TDC</th>
    <th>Tipo de facturación</th>
    <th>Periodicidad</th>
    <th>Facturación</th>
    <th>Notas</th>
  </tr>
{% endblock %}

{% block tabla_body %}
  {% for g in gastos %}
    <tr>
      <td>
        <a class="btn-detalle" href="{% url 'gastos_mercadotecnia_gasto_update' g.id %}?next={{ request.get_full_path|urlencode }}">Detalle</a>
      </td>
      <td>{{ g.fecha_facturacion|date:"d/m/Y"|default_if_none:"" }}</td>
      <td>{{ g.categoria|default_if_none:"" }}</td>
      <td>{{ g.plataforma|default_if_none:"" }}</td>
      <td>{{ g.marca|default_if_none:"" }}</td>
      <td>{{ g.tdc|default_if_none:"" }}</td>
      <td>{{ g.tipo_facturacion|default_if_none:"" }}</td>
      <td>{{ g.periodicidad|default_if_none:"" }}</td>
      <td>{{ g.facturacion|currency }}</td>
      <td>{{ g.notas|default_if_none:"" }}</td>
    </tr>
  {% empty %}
    <tr><td colspan="10">Sin registros.</td></tr>
  {% endfor %}
{% endblock %}
