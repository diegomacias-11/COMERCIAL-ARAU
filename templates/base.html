{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}ARAU{% endblock %}</title>
  <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  {% block extra_head %}{% endblock %}
  
</head>
<body>
  {% include 'includes/header.html' %}

  <section class="avisos-zone">
    {% if messages %}
      {% for message in messages %}
        <div class="aviso {% if message.tags %}aviso-{{ message.tags }}{% endif %}">{{ message }}</div>
      {% endfor %}
    {% endif %}
    {% block avisos %}{% endblock %}
  </section>

  <main>
    {% block content %}{% endblock %}
  </main>

  <div id="table-scroll-bottom" class="table-scroll-bottom" aria-hidden="true">
    <div class="table-scroll-inner"></div>
  </div>

  <script>
    (function () {
      const bottom = document.getElementById("table-scroll-bottom");
      const inner = bottom ? bottom.querySelector(".table-scroll-inner") : null;
      if (!bottom || !inner) return;
      let activeContainer = null;

      function updateWidth(container) {
        const table = container.querySelector("table");
        if (!table) return;
        inner.style.width = `${table.scrollWidth}px`;
      }

      function setActive(container) {
        activeContainer = container;
        updateWidth(container);
        bottom.scrollLeft = container.scrollLeft;
      }

      function onContainerScroll(e) {
        if (activeContainer !== e.currentTarget) return;
        bottom.scrollLeft = activeContainer.scrollLeft;
      }

      function onBottomScroll() {
        if (!activeContainer) return;
        activeContainer.scrollLeft = bottom.scrollLeft;
      }

      const containers = Array.from(document.querySelectorAll(".table-container"));
      containers.forEach((c) => {
        c.addEventListener("mouseenter", () => setActive(c));
        c.addEventListener("scroll", onContainerScroll);
      });
      bottom.addEventListener("scroll", onBottomScroll);
      if (containers[0]) {
        setActive(containers[0]);
      }
      window.addEventListener("resize", () => {
        if (activeContainer) updateWidth(activeContainer);
      });
    })();
  </script>
</body>
</html>
